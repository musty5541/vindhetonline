<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>VindHetOnline - Advertenties</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .filter { margin-bottom: 20px; }
    .advertentie { border: 1px solid #ccc; padding: 10px; margin-bottom: 15px; border-radius: 8px; }
    .advertentie img { max-width: 150px; border-radius: 5px; display: block; margin-top: 10px; }
  </style>
</head>
<body>

  <h1>Advertenties</h1>

  <div class="filter">
    <label for="categorie">Categorie:</label>
    <select id="categorie">
      <option value="">Alle</option>
      <option value="Auto">Auto</option>
      <option value="Elektronica">Elektronica</option>
      <option value="Meubels">Meubels</option>
    </select>

    <label for="merk">Merk:</label>
    <input type="text" id="merk" placeholder="Bijv: Audi, Samsung" />
  </div>

  <div id="advertenties">Laden...</div>

  <script>
    let advertentiesData = [];

    async function fetchData() {
      try {
        const res = await fetch('/data/listings.json');
        if (!res.ok) throw new Error('Fout bij laden');
        advertentiesData = await res.json();
        renderAdvertenties(advertentiesData);
      } catch (err) {
        document.getElementById('advertenties').innerText = 'Fout bij het laden van data.';
        console.error(err);
      }
    }

    function renderAdvertenties(data) {
      const container = document.getElementById('advertenties');
      container.innerHTML = '';
      if (data.length === 0) {
        container.innerHTML = '<p>Geen advertenties gevonden.</p>';
        return;
      }

      data.forEach(item => {
        const div = document.createElement('div');
        div.className = 'advertentie';
        div.innerHTML = `
          <h2>${item.titel}</h2>
          <p><strong>Merk:</strong> ${item.merk || '-'} | <strong>Model:</strong> ${item.model || '-'}</p>
          <p><strong>Prijs:</strong> â‚¬${item.prijs}</p>
          ${item.afbeeldingen?.[0] ? `<img src="${item.afbeeldingen[0]}" alt="${item.titel}" />` : ''}
        `;
        container.appendChild(div);
      });
    }

    function applyFilters() {
      const categorie = document.getElementById('categorie').value.toLowerCase();
      const merk = document.getElementById('merk').value.toLowerCase();

      const filtered = advertentiesData.filter(item => {
        const matchCategorie = categorie ? item.categorie?.toLowerCase() === categorie : true;
        const matchMerk = merk ? item.merk?.toLowerCase().includes(merk) : true;
        return matchCategorie && matchMerk;
      });

      renderAdvertenties(filtered);
    }

    document.getElementById('categorie').addEventListener('change', applyFilters);
    document.getElementById('merk').addEventListener('input', applyFilters);

    fetchData();
  </script>

</body>
</html>
